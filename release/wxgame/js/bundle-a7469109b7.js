!function(){"use strict";class e{}e.num=1,e.pps="",e.EVEN_GAMEOVER="EVEN_GAMEOVER";class t extends Laya.Script{constructor(){super(),this.bSpeed=20,this.bHarm=1}onEnable(){this.owner.getComponent(Laya.RigidBody).setVelocity({x:0,y:-this.bSpeed})}onTriggerEnter(e,t,a){"role"!=e.label&&this.owner.removeSelf()}onUpdate(){this.owner.y<-10&&this.owner.removeSelf()}onDisable(){Laya.Pool.recover("bullet",this.owner)}}class a extends Laya.Script{constructor(){super(),this.mid=1,this.mSpeed=1,this.mBlood=1}onEnable(){Laya.stage.on(e.EVEN_GAMEOVER,this,this.gameOver),this.owner.getComponent(Laya.RigidBody).setVelocity({x:0,y:2})}setMonsterID(e=0){this.mid=e}setMonsterBlood(e=0){this.mBlood=e,this.labNum.text=this.mBlood.toString()}steMonsterSpeed(e=1){this.mSpeed=e,this.owner.getComponent(Laya.RigidBody).setVelocity({x:0,y:this.mSpeed})}monsterDie(){this.owner.removeSelf()}gameOver(){this.owner.getComponent(Laya.RigidBody).setVelocity({x:0,y:0})}onTriggerEnter(e,a,i){if("buttle"==e.label){let a=e.owner.getComponent(t).bHarm;this.mBlood-=a,this.labNum.text=this.mBlood.toString(),this.mBlood<=0&&this.monsterDie()}}onUpdate(){if(9==this.mid){this.owner.y>=4800&&Laya.stage.event(e.EVEN_GAMEOVER)}}onDisable(){Laya.Pool.recover("monster",this.owner)}}class i extends Laya.Script{constructor(){super(),this.rSpeed=10,this.moveDir=0}onEnable(){this._rig=this.owner.getComponent(Laya.RigidBody)}onTriggerEnter(e,t,i){if("monster"==e.label){e.owner.getComponent(a);this.roleDie()}}roleDie(){Laya.stage.event(e.EVEN_GAMEOVER)}steSpeedDir(e=0){this.moveDir=e,1==e?this._rig.setVelocity({x:-this.rSpeed,y:0}):2==e?this._rig.setVelocity({x:this.rSpeed,y:0}):0==e&&this._rig.setVelocity({x:0,y:0})}onUpdate(){let e=Laya.stage.width,t=(Laya.stage.height,this.owner);return 1==this.moveDir&&t.x<=0?this._rig.setVelocity({x:0,y:0}):2==this.moveDir&&t.x>=e-t.width?this._rig.setVelocity({x:0,y:0}):void 0}onDisable(){}}class s extends Laya.Script{constructor(){super(),this.creBulletTime1=8,this.creBulletTime2=0,this.moveBgTime1=2,this.moveBgTime2=0}onEnable(){Laya.MouseManager.multiTouchEnabled=!1,Laya.stage.on(e.EVEN_GAMEOVER,this,this.gameOver),this.leftBtn.on(Laya.Event.MOUSE_DOWN,this,this.touchLeftStart),this.leftBtn.on(Laya.Event.MOUSE_UP,this,this.touchEnd),this.rightBtn.on(Laya.Event.MOUSE_DOWN,this,this.touchRightStart),this.rightBtn.on(Laya.Event.MOUSE_UP,this,this.touchEnd),this.posArr=[{mid:1,type:1,pos:new Laya.Point(96,3993),data:10},{mid:2,type:1,pos:new Laya.Point(520,3524),data:20},{mid:3,type:1,pos:new Laya.Point(68,3028),data:30},{mid:4,type:1,pos:new Laya.Point(553,2531),data:40},{mid:5,type:1,pos:new Laya.Point(68,1980),data:50},{mid:6,type:1,pos:new Laya.Point(533,1429),data:60},{mid:7,type:1,pos:new Laya.Point(83,1005),data:70},{mid:8,type:1,pos:new Laya.Point(520,496),data:80},{mid:9,type:1,pos:new Laya.Point(280,16),data:90}],this.msterSpr.removeChildren(),this.posArr.forEach(e=>{1==e.type?this.buildMonster(e):this.buildProp(e.mid,e.pos)});let t=Laya.stage.height;this.sprBg1.y=t-this.sprBg1.height,this.sprBg2.y=this.sprBg1.y-this.sprBg2.height,Laya.timer.frameLoop(1,this,this.moveBg),Laya.timer.frameLoop(10,this,this.buildBullet),this.buildRole()}buildRole(){let e=Laya.stage.width,t=Laya.stage.height;this.roleNode=this.rolePrefab.create(),this.roleSpr.addChild(this.roleNode),this.roleNode.pos(e/2-this.roleNode.width/2,t-this.roleNode.height-200)}buildMonster(e){let t=Laya.Pool.getItemByCreateFun("monster",this.monsterPrefab.create,this.monsterPrefab),i=t.getComponent(a);t.pos(e.pos.x,e.pos.y),i.setMonsterID(e.mid),i.setMonsterBlood(e.data),this.msterSpr.addChild(t)}buildProp(e,t){let i=Laya.Pool.getItemByCreateFun("prop",this.propPrefab.create,this.propPrefab);i.getComponent(a);i.pos(t.x,t.y),this.msterSpr.addChild(i)}buildBullet(){let e=Laya.Pool.getItemByCreateFun("bullet",this.bulletPrefab.create,this.bulletPrefab),t=this.roleNode.x+this.roleNode.width/2-e.width/2,a=this.roleNode.y;e.pos(t,a),this.roleSpr.addChild(e)}touchLeftStart(){this.roleNode.getComponent(i).steSpeedDir(1)}touchRightStart(){this.roleNode.getComponent(i).steSpeedDir(2)}touchEnd(){this.roleNode.getComponent(i).steSpeedDir(0)}moveBg(){Laya.stage.width;let e=Laya.stage.height;this.sprBg1.y>=e&&(this.sprBg1.y=this.sprBg2.y-this.sprBg1.height),this.sprBg2.y>=e&&(this.sprBg2.y=this.sprBg1.y-this.sprBg2.height),this.sprBg1.y+=10,this.sprBg2.y+=10}gameOver(){Laya.timer.clearAll(this),Laya.Scene.open("views/LoseView.scene")}onUpdate(){}onDisable(){}}class o extends Laya.Script{constructor(){super()}onEnable(){this.btnStart.on(Laya.Event.CLICK,this,()=>{Laya.Scene.open("GameView.scene")})}onDisable(){}}var n,r=Laya.View,l=Laya.ClassUtils.regClass;!function(e){!function(e){class t extends Laya.EffectAnimation{constructor(){super(),this.effectData=t.uiView}}t.uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:0,x:0,texture:"comp/x.png"},compId:3}],animations:[{nodes:[{target:3,keyframes:{scaleY:[{value:.8,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:5}],scaleX:[{value:.8,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:5}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["comp/x.png"],loadList3D:[]},e.saceToNormalUI=t,l("ui.ani.saceToNormalUI",t);class a extends Laya.EffectAnimation{constructor(){super(),this.effectData=a.uiView}}a.uiView={type:"View",props:{},compId:2,child:[{type:"Button",props:{y:0,x:0,skin:"comp/button.png",label:"label",labelSize:28,labelFont:"SimHei",labelColors:"#fff,#fff,#e7ce4e",sizeGrid:"14,16,15,19",width:160,labelPadding:"0,0,1,0"},compId:3}],animations:[{nodes:[{target:3,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:24}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:24}]}}],name:"ani1",id:1,frameRate:60,action:0}],loadList:["comp/button.png"],loadList3D:[]},e.scaleUI=a,l("ui.ani.scaleUI",a);class i extends Laya.EffectAnimation{constructor(){super(),this.effectData=i.uiView}}i.uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"comp/img_blank.png"},compId:3}],animations:[{nodes:[{target:3,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:6}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:6}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["comp/img_blank.png"],loadList3D:[]},e.scaleToBigUI=i,l("ui.ani.scaleToBigUI",i);class s extends Laya.EffectAnimation{constructor(){super(),this.effectData=s.uiView}}s.uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"comp/img_hd.png"},compId:4}],animations:[{nodes:[{target:4,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:0},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:6}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:0},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:6}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["comp/img_hd.png"],loadList3D:[]},e.scaleToSmallUI=s,l("ui.ani.scaleToSmallUI",s)}(e.ani||(e.ani={}))}(n||(n={})),function(e){class t extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("GameView")}}e.GameViewUI=t,l("ui.GameViewUI",t);class a extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("Loading")}}e.LoadingUI=a,l("ui.LoadingUI",a)}(n||(n={})),function(e){!function(e){class t extends r{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("physicsDemo/PhysicsGameMain")}}e.PhysicsGameMainUI=t,l("ui.physicsDemo.PhysicsGameMainUI",t)}(e.physicsDemo||(e.physicsDemo={}))}(n||(n={}));class h extends n.LoadingUI{onAwake(){Laya.loader.load(["bg/background.jpg","bg/bg14.png","bg/img_bg4.png","bg/bg.png","demo/fcs.jpg","demo/whs.jpg","res/atlas/bag.atlas","res/atlas/bg.atlas","res/atlas/cd.atlas","res/atlas/comp.atlas","role/atlasAni/139x.atlas","role/spineAni/dragon.sk","role/spineAni/goblins.sk","res/atlas/role/frameAni.atlas","res/atlas/role.atlas","res/atlas/test.atlas","files/layaAir.mp4","res/atlas/mainUi.atlas","bigPicture/bg_daohang_paodao.png","bigPicture/bg_daohang_xiaoyouxi.jpg"],Laya.Handler.create(this,this.load3D)),Laya.loader.on(Laya.Event.ERROR,this,this.onError)}load3D(){Laya.loader.create(["d3/dude/dude.lh","d3/LayaMonkey2/LayaMonKey.lh","d3/BoneLinkScene/PangZi.lh","d3/trail/Cube.lh"],Laya.Handler.create(this,this.loadConfig))}loadConfig(){Laya.loader.create(["json/mailList.json","json/test.json"],Laya.Handler.create(this,this.onLoaded),Laya.Handler.create(this,this.onLoading))}onError(e){console.log("加载失败: "+e)}onLoading(e){this.progress.value=e>.92?.95:e}onLoaded(){this.progress.value=.98,Laya.timer.once(1e3,this,()=>{Laya.Scene.open("Index.scene")})}}class d extends Laya.Script{constructor(){super(),this.createBoxInterval=1e3,this._time=0,this._started=!1,this.updateStop=!1}onEnable(){this._time=Date.now(),this._gameBox=this.owner.getChildByName("gameBox"),Laya.stage.on(Laya.Event.BLUR,this,()=>{this.updateStop=!0}),Laya.stage.on(Laya.Event.FOCUS,this,()=>{this.updateStop=!1})}onStart(){this.owner.getChildByName("ground").getComponent(Laya.BoxCollider).width=Laya.stage.width}onUpdate(){if(this.updateStop)return;let e=Date.now();e-this._time>this.createBoxInterval&&this._started&&(this._time=e,this.createBox())}createBox(){let e=Laya.Pool.getItemByCreateFun("dropBox",this.dropBox.create,this.dropBox);e.pos(Math.random()*(Laya.stage.width-100),-100),this._gameBox.addChild(e)}onStageClick(e){e.stopPropagation();let t=Laya.Pool.getItemByCreateFun("bullet",this.bullet.create,this.bullet);t.pos(Laya.stage.mouseX,Laya.stage.mouseY),this._gameBox.addChild(t)}startGame(){this._started||(this._started=!0,this.enabled=!0)}stopGame(){this._started=!1,this.enabled=!1,this.createBoxInterval=1e3,this._gameBox.removeChildren()}}class c extends n.physicsDemo.PhysicsGameMainUI{constructor(){super(),c.instance=this,Laya.MouseManager.multiTouchEnabled=!1}onEnable(){this._control=this.getComponent(d),this.tipLbll.on(Laya.Event.CLICK,this,this.onTipClick)}onTipClick(e){this.tipLbll.visible=!1,this._score=0,this.scoreLbl.text="",this._control.startGame()}addScore(e=1){this._score+=e,this.scoreLbl.changeText("分数："+this._score),this._control.createBoxInterval>600&&this._score%20==0&&(this._control.createBoxInterval-=20)}stopGame(){this.tipLbll.visible=!0,this.tipLbll.text="游戏结束了，点击屏幕重新开始",this._control.stopGame()}}class y extends Laya.Script{constructor(){super()}onEnable(){this.btnAgain.on(Laya.Event.CLICK,this,()=>{Laya.Scene.open("GameView.scene")})}onDisable(){}}class p extends Laya.Script{constructor(){super()}onEnable(){this.btnAgain.on(Laya.Event.CLICK,this,()=>{Laya.Scene.open("GameView.scene")})}onDisable(){}}class g extends Laya.Script{constructor(){super()}onEnable(){this.owner.getComponent(Laya.RigidBody).setVelocity({x:0,y:-10})}onTriggerEnter(e,t,a){this.owner.removeSelf()}onUpdate(){this.owner.y<-10&&this.owner.removeSelf()}onDisable(){Laya.Pool.recover("bullet",this.owner)}}class m extends Laya.Script{constructor(){super(),this.level=1}onEnable(){this._rig=this.owner.getComponent(Laya.RigidBody),this.level=Math.round(5*Math.random())+1,this._text=this.owner.getChildByName("levelTxt"),this._text.text=this.level+""}onUpdate(){this.owner.rotation++}onTriggerEnter(e,t,a){var i=this.owner;if("buttle"===e.label){if(this.level>1)this.level--,this._text.changeText(this.level+""),i.getComponent(Laya.RigidBody).setVelocity({x:0,y:-10}),Laya.SoundManager.playSound("sound/hit.wav");else if(i.parent){let e=Laya.Pool.getItemByCreateFun("effect",this.createEffect,this);e.pos(i.x,i.y),i.parent.addChild(e),e.play(0,!0),i.removeSelf(),Laya.SoundManager.playSound("sound/destroy.wav")}c.instance.addScore(1)}else"ground"===e.label&&(i.removeSelf(),c.instance.stopGame())}createEffect(){let e=new Laya.Animation;return e.loadAnimation("ani/TestAni.ani"),e.on(Laya.Event.COMPLETE,null,function(){e.removeSelf(),Laya.Pool.recover("effect",e)}),e}onDisable(){Laya.Pool.recover("dropBox",this.owner)}}var u=Laya.Keyboard,L=Laya.KeyBoardManager;class w extends Laya.Script{constructor(){super()}onEnable(){this._owner=this.owner,this.roleStand=this._owner.getChildByName("roleStand"),this.roleRun=this._owner.getChildByName("roleRun"),this.bg=this.owner.parent}playRoleAni(e,t="stand"){"run"==t?(this.roleStand.visible=!1,this.roleStand.isPlaying&&this.roleStand.stop(),this.roleRun.visible=!0,this.roleRun.play(0,!0,e)):(this.roleRun.visible=!1,this.roleRun.isPlaying&&this.roleRun.stop(),this.roleStand.play(0,!0,e),this.roleStand.visible=!0)}onUpdate(){this.lastRoleDirection=this.roleDirection,L.hasKeyDown(u.UP)||L.hasKeyDown(u.W)?(this.roleDirection="Up",this._owner.y-=2,this._owner.y<80&&(this._owner.y=80)):L.hasKeyDown(u.DOWN)||L.hasKeyDown(u.S)?(this.roleDirection="Down",this._owner.y+=2,this._owner.y>this.bg.height-130&&(this._owner.y=this.bg.height-130)):L.hasKeyDown(u.LEFT)||L.hasKeyDown(u.A)?(this.roleDirection="Left",this._owner.x-=2,this._owner.x<30&&(this._owner.x=30)):(L.hasKeyDown(u.RIGHT)||L.hasKeyDown(u.D))&&(this.roleDirection="Right",this._owner.x+=2,this._owner.x>this.bg.width-130&&(this._owner.x=this.bg.width-130)),this.lastRoleDirection!==this.roleDirection&&this.playRoleAni(this.roleDirection,"run")}onKeyUp(e){this.playRoleAni(this.roleDirection),this.roleDirection=""}onDisable(){}}class b{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("GameView.ts",s),e("Index.ts",o),e("LoadingRT.ts",h),e("scence/physicsDemo/PhysicsGameMainRT.ts",c),e("scence/physicsDemo/PhysicsGameMain.ts",d),e("views/LoseView.ts",y),e("views/VictoryView.ts",p),e("prefab/Bullet.ts",g),e("prefab/BulletPrefab.ts",t),e("prefab/DropBox.ts",m),e("prefab/MonsterPrefab.ts",a),e("prefab/Role.ts",w),e("prefab/RolePrefab.ts",i)}}b.width=750,b.height=1334,b.scaleMode="fixedwidth",b.screenMode="none",b.alignV="middle",b.alignH="center",b.startScene="Loading.scene",b.sceneRoot="",b.debug=!1,b.stat=!1,b.physicsDebug=!0,b.exportSceneToJson=!0,b.init();new class{constructor(){Config.useRetinalCanvas=!0,window.Laya3D?Laya3D.init(b.width,b.height):Laya.init(b.width,b.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=b.scaleMode,Laya.stage.screenMode=b.screenMode,Laya.stage.alignV=b.alignV,Laya.stage.alignH=b.alignH,Laya.stage.bgColor="#efeed7",Laya.URL.exportSceneToJson=b.exportSceneToJson,(b.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),b.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version-2a29970b88.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){b.startScene&&Laya.Scene.open(b.startScene)}}}();